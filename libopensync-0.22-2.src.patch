diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/formats/Makefile.am src/libopensync-0.22/formats/Makefile.am
--- origsrc/libopensync-0.22/formats/Makefile.am	2007-03-27 06:49:27.000000000 -0500
+++ src/libopensync-0.22/formats/Makefile.am	2007-09-04 00:25:14.968750000 -0500
@@ -12,27 +12,27 @@
 formats_LTLIBRARIES = data.la event.la todo.la contact.la note.la file.la
 
 data_la_SOURCES = data.c
-data_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-data_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+data_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+data_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 event_la_SOURCES = event.c
-event_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-event_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+event_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+event_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 note_la_SOURCES = note.c
-note_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-note_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+note_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+note_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 todo_la_SOURCES = todo.c
-todo_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-todo_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+todo_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+todo_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 contact_la_SOURCES = contact.c
-contact_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-contact_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+contact_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+contact_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 file_la_SOURCES = file.c
-file_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-file_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+file_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+file_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @LIBS@
 
 SUBDIRS = vformats-xml
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/formats/vformats-xml/Makefile.am src/libopensync-0.22/formats/vformats-xml/Makefile.am
--- origsrc/libopensync-0.22/formats/vformats-xml/Makefile.am	2007-03-27 06:49:27.000000000 -0500
+++ src/libopensync-0.22/formats/vformats-xml/Makefile.am	2007-09-04 00:21:53.203125000 -0500
@@ -22,29 +22,29 @@
 lib_LTLIBRARIES =  libopensync-xml.la
 
 xml_vcard_la_SOURCES = xml-vcard.c vformat.c
-xml_vcard_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xml_vcard_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xml_vcard_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xml_vcard_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 xml_vcal_la_SOURCES = xml-vcal.c vformat.c vcalical.c
-xml_vcal_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xml_vcal_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xml_vcal_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xml_vcal_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 xml_vnote_la_SOURCES = xml-vnote.c vformat.c
-xml_vnote_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xml_vnote_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xml_vnote_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xml_vnote_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 xml_evolution_la_SOURCES = xml-evolution.c vformat.c
-xml_evolution_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xml_evolution_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xml_evolution_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xml_evolution_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 xml_kde_la_SOURCES = xml-kde.c vformat.c
-xml_kde_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xml_kde_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xml_kde_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xml_kde_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 xmldoc_la_SOURCES = xmldoc.c
-xmldoc_la_LDFLAGS = -avoid-version -export-dynamic -module @GCOV_LDFLAGS@
-xmldoc_la_LIBADD = @PACKAGE_LIBS@ @LIBS@ libopensync-xml.la
+xmldoc_la_LDFLAGS = -module -avoid-version -export-dynamic -no-undefined @GCOV_LDFLAGS@
+xmldoc_la_LIBADD = libopensync-xml.la $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
 
 libopensync_xml_la_SOURCES = xml-support.c
-libopensync_xml_la_LDFLAGS = @GCOV_LDFLAGS@
-libopensync_xml_la_LIBADD = @PACKAGE_LIBS@ @LIBS@
+libopensync_xml_la_LDFLAGS = @GCOV_LDFLAGS@ -no-undefined
+libopensync_xml_la_LIBADD = $(top_builddir)/opensync/libopensync.la @PACKAGE_LIBS@ @XML_LIBS@ @LIBS@
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/formats/vformats-xml/vformat.c src/libopensync-0.22/formats/vformats-xml/vformat.c
--- origsrc/libopensync-0.22/formats/vformats-xml/vformat.c	2007-03-27 06:49:27.000000000 -0500
+++ src/libopensync-0.22/formats/vformats-xml/vformat.c	2007-09-03 23:44:02.296875000 -0500
@@ -236,7 +236,7 @@
 	if (charset) {
 
 		cd = iconv_open("UTF-8", charset->str);
-#ifdef SOLARIS
+#if defined(SOLARIS) || defined(__CYGWIN__)
                 if (iconv(cd, (const char**)&inbuf, &inbytesleft, &p, &outbytesleft) != (size_t)(-1)) {
 #else
                 if (iconv(cd, &inbuf, &inbytesleft, &p, &outbytesleft) != (size_t)(-1)) {
@@ -264,7 +264,7 @@
 
 			/* because inbuf is not UTF-8, we think it is ISO-8859-1 */
                         cd = iconv_open("UTF-8", "ISO-8859-1");
-#ifdef SOLARIS
+#if defined(SOLARIS) || defined(__CYGWIN__)
                         if (iconv(cd, (const char**)&inbuf, &inbytesleft, &p, &outbytesleft) != (size_t)(-1)) {
 #else
                         if (iconv(cd, &inbuf, &inbytesleft, &p, &outbytesleft) != (size_t)(-1)) {
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/opensync/Makefile.am src/libopensync-0.22/opensync/Makefile.am
--- origsrc/libopensync-0.22/opensync/Makefile.am	2007-03-27 06:49:18.000000000 -0500
+++ src/libopensync-0.22/opensync/Makefile.am	2007-09-03 23:45:34.515625000 -0500
@@ -77,5 +77,5 @@
 	*.bbg \
 	*.da
 
-libopensync_la_LDFLAGS = @PACKAGE_LIBS@ @GCOV_LDFLAGS@
+libopensync_la_LDFLAGS = @PACKAGE_LIBS@ @GCOV_LDFLAGS@ -no-undefined
 libopensync_la_LIBADD = @XML_LIBS@
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/opensync/opensync_plugin.c src/libopensync-0.22/opensync/opensync_plugin.c
--- origsrc/libopensync-0.22/opensync/opensync_plugin.c	2007-03-27 06:49:18.000000000 -0500
+++ src/libopensync-0.22/opensync/opensync_plugin.c	2007-09-04 00:15:27.203125000 -0500
@@ -370,7 +370,7 @@
 	while ((de = g_dir_read_name(dir))) {
 		filename = g_strdup_printf ("%s/%s", path, de);
 		
-		if (!g_file_test(filename, G_FILE_TEST_IS_REGULAR) || g_file_test(filename, G_FILE_TEST_IS_SYMLINK) || !g_pattern_match_simple("*.so", filename)) {
+		if (!g_file_test(filename, G_FILE_TEST_IS_REGULAR) || g_file_test(filename, G_FILE_TEST_IS_SYMLINK) || !g_pattern_match_simple("*."G_MODULE_SUFFIX, filename)) {
 			g_free(filename);
 			continue;
 		}
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/osengine/Makefile.am src/libopensync-0.22/osengine/Makefile.am
--- origsrc/libopensync-0.22/osengine/Makefile.am	2007-03-27 06:49:26.000000000 -0500
+++ src/libopensync-0.22/osengine/Makefile.am	2007-09-03 23:46:01.578125000 -0500
@@ -43,5 +43,5 @@
 	*.bbg \
 	*.da
 
-libosengine_la_LDFLAGS = $(PACKAGE_LIBS) -R $(libdir) @GCOV_LDFLAGS@
+libosengine_la_LDFLAGS = $(PACKAGE_LIBS) -R $(libdir) @GCOV_LDFLAGS@ -no-undefined
 libosengine_la_LIBADD = $(top_builddir)/opensync/libopensync.la
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libopensync-0.22/wrapper/Makefile.am src/libopensync-0.22/wrapper/Makefile.am
--- origsrc/libopensync-0.22/wrapper/Makefile.am	2007-03-27 06:49:09.000000000 -0500
+++ src/libopensync-0.22/wrapper/Makefile.am	2007-09-03 23:46:40.468750000 -0500
@@ -22,5 +22,5 @@
 endif
 
 nodist__opensync_la_SOURCES = opensync_wrap.c
-_opensync_la_LDFLAGS = @PACKAGE_LIBS@ @XML_LIBS@ $(PYTHON_LDFLAGS) -R $(libdir) -module -avoid-version
+_opensync_la_LDFLAGS = @PACKAGE_LIBS@ @XML_LIBS@ $(PYTHON_LDFLAGS) -R $(libdir) -module -avoid-version -no-undefined
 _opensync_la_LIBADD = $(top_builddir)/opensync/libopensync.la
